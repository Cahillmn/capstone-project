{"version":3,"file":"vue-gtag.umd.min.js","sources":["../src/util.js","../src/api/query.js","../src/install.js","../src/api/config.js","../src/api/event.js","../src/api/pageview.js","../src/api/screenview.js","../src/api/ga-disable.js","../src/api/opt-out.js","../src/api/index.js","../src/api/custom-map.js","../src/api/time.js","../src/api/exception.js","../src/api/linker.js","../src/api/purchase.js","../src/api/refund.js","../src/api/set.js","../src/api/opt-in.js","../src/extend.js","../src/page-tracker.js","../src/bootstrap.js","../src/index.js"],"sourcesContent":["export const noop = function() {};\n\nexport function loadScript(url, domain) {\n  return new Promise((resolve, reject) => {\n    const head = document.head || document.getElementsByTagName(\"head\")[0];\n    const script = document.createElement(\"script\");\n\n    script.async = true;\n    script.src = url;\n    script.charset = \"utf-8\";\n\n    if (domain) {\n      const link = document.createElement(\"link\");\n\n      link.href = domain;\n      link.rel = \"preconnect\";\n\n      head.appendChild(link);\n    }\n\n    head.appendChild(script);\n\n    script.onload = resolve;\n    script.onerror = reject;\n  });\n}\n\nexport function warn(msg, err) {\n  console.warn(\"[vue-gtag] \" + msg);\n\n  if (err && err.stack) {\n    console.warn(err.stack);\n  }\n}\n\nexport function isFn(item) {\n  return typeof item === \"function\";\n}\n\nexport function isObject(item) {\n  return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nexport function mergeDeep(target, ...sources) {\n  if (!sources.length) {\n    return target;\n  }\n\n  const source = sources.shift();\n\n  if (!isObject(target) || !isObject(source)) {\n    return;\n  }\n\n  for (const key in source) {\n    if (isObject(source[key])) {\n      if (!target[key]) {\n        Object.assign(target, { [key]: {} });\n      }\n\n      mergeDeep(target[key], source[key]);\n    } else {\n      Object.assign(target, { [key]: source[key] });\n    }\n  }\n\n  return mergeDeep(target, ...sources);\n}\n","import { getOptions } from \"../install\";\n\nexport default function(...args) {\n  const { globalObjectName } = getOptions();\n\n  if (typeof window === \"undefined\") {\n    return;\n  }\n\n  window[globalObjectName](...args);\n}\n","import { noop, mergeDeep } from \"./util\";\nimport extend from \"./extend\";\nimport bootstrap from \"./bootstrap\";\n\nlet Vue;\nlet Router;\n\nexport let options = {\n  pageTrackerTemplate: noop,\n  onBeforeTrack: noop,\n  onAfterTrack: noop,\n  onReady: noop,\n  enabled: true,\n  disableScriptLoad: false,\n  bootstrap: true,\n  globalObjectName: \"gtag\",\n  globalDataLayerName: \"dataLayer\",\n  pageTrackerEnabled: true,\n  pageTrackerScreenviewEnabled: false,\n  pageTrackerSkipSamePath: true,\n  defaultGroupName: \"default\",\n  includes: null,\n  config: null\n};\n\nexport const getOptions = () => options;\nexport const setOptions = _options => mergeDeep(options, _options);\nexport const getVue = () => Vue;\nexport const getRouter = () => Router;\n\nexport function install(_Vue, _options = {}, _Router) {\n  Vue = _Vue;\n  Router = _Router;\n\n  setOptions(_options);\n\n  extend();\n\n  if (!options.bootstrap) {\n    return;\n  }\n\n  bootstrap();\n}\n","import query from \"./query\";\nimport { getOptions } from \"../install\";\n\nexport default (...args) => {\n  const { config, includes } = getOptions();\n\n  query(\"config\", config.id, ...args);\n\n  if (Array.isArray(includes)) {\n    includes.forEach(domain => {\n      query(\"config\", domain.id, ...args);\n    });\n  }\n};\n","import { getOptions } from \"../install\";\nimport query from \"./query\";\n\nexport default (name, _params = {}) => {\n  const { defaultGroupName, includes } = getOptions();\n  const params = _params;\n\n  if (includes && params.send_to == null) {\n    params.send_to = includes\n      .map(include => include.id)\n      .concat(defaultGroupName);\n  }\n\n  query(\"event\", name, params);\n};\n","import config from \"./config\";\n\nexport default (...args) => {\n  const [arg] = args;\n  let params = {};\n\n  if (typeof arg === \"string\") {\n    params = {\n      page_path: arg,\n      page_location: window.location.href\n    };\n  } else {\n    params = arg;\n  }\n\n  config(params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"screen_view\", ...args);\n};\n","import { getOptions } from \"../install\";\n\nexport default (value = true) => {\n  const { includes, config } = getOptions();\n\n  window[`ga-disable-${config.id}`] = value;\n\n  if (Array.isArray(includes)) {\n    includes.forEach(domain => {\n      window[`ga-disable-${domain.id}`] = value;\n    });\n  }\n};\n","import disable from \"./ga-disable\";\n\nexport default () => {\n  disable(true);\n};\n","import query from \"./query\";\nimport config from \"./config\";\nimport event from \"./event\";\nimport pageview from \"./pageview\";\nimport screenview from \"./screenview\";\nimport customMap from \"./custom-map\";\nimport time from \"./time\";\nimport exception from \"./exception\";\nimport linker from \"./linker\";\nimport purchase from \"./purchase\";\nimport refund from \"./refund\";\nimport set from \"./set\";\nimport optIn from \"./opt-in\";\nimport optOut from \"./opt-out\";\n\nexport default {\n  query,\n  config,\n  event,\n  pageview,\n  screenview,\n  customMap,\n  time,\n  exception,\n  linker,\n  purchase,\n  refund,\n  set,\n  optIn,\n  optOut\n};\n","import config from \"./config\";\n\nexport default map => {\n  config({\n    custom_map: map\n  });\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"timing_complete\", ...args);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"exception\", ...args);\n};\n","import config from \"./config\";\n\nexport default params => {\n  config(\"linker\", params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"purchase\", ...args);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"refund\", ...args);\n};\n","import query from \"./query\";\n\nexport default (...args) => {\n  query(\"set\", ...args);\n};\n","import disable from \"./ga-disable\";\n\nexport default () => {\n  disable(false);\n};\n","import { getVue } from \"./install\";\nimport api from \"./api\";\n\nexport default () => {\n  const Vue = getVue();\n\n  Vue.$gtag = Vue.prototype.$gtag = api;\n};\n","import { getVue, getRouter, getOptions } from \"./install\";\nimport { warn } from \"./util\";\nimport pageview from \"./api/pageview\";\nimport screenview from \"./api/screenview\";\n\nexport const getPageviewTemplate = (to = {}, from = {}) => {\n  const {\n    pageTrackerTemplate,\n    pageTrackerScreenviewEnabled,\n    appName\n  } = getOptions();\n\n  let template;\n  const customTemplate = pageTrackerTemplate(to, from);\n\n  if (customTemplate) {\n    template = customTemplate;\n  } else if (pageTrackerScreenviewEnabled) {\n    template = {\n      app_name: appName,\n      screen_name: to.name\n    };\n  } else {\n    template = {\n      page_title: to.name,\n      page_path: to.path,\n      page_location: window.location.href\n    };\n  }\n\n  return template;\n};\n\nexport const trackPage = ({ to = {}, from = {}, params = {} } = {}) => {\n  const {\n    pageTrackerSkipSamePath,\n    pageTrackerScreenviewEnabled\n  } = getOptions();\n\n  if (pageTrackerSkipSamePath && to.path === from.path) {\n    return;\n  }\n\n  const newParams = {\n    ...getPageviewTemplate(to, from),\n    ...params\n  };\n\n  if (pageTrackerScreenviewEnabled && !newParams.app_name) {\n    warn(\"To use the screenview, add the appName to the plugin options\");\n    return;\n  }\n\n  if (pageTrackerScreenviewEnabled && !newParams.screen_name) {\n    warn(\"To use the screenview, name your routes\");\n    return;\n  }\n\n  if (pageTrackerScreenviewEnabled) {\n    screenview(newParams);\n    return;\n  }\n\n  pageview(newParams);\n};\n\nexport const startRouter = Router => {\n  const Vue = getVue();\n  const { onBeforeTrack, onAfterTrack, config } = getOptions();\n\n  /* istanbul ignore next */\n  Router.onReady(current => {\n    Vue.nextTick().then(() => {\n      trackPage({ to: current, params: config.params });\n    });\n\n    Router.afterEach((to, from) => {\n      Vue.nextTick().then(() => {\n        onBeforeTrack(to, from);\n        trackPage({ to, from });\n        onAfterTrack(to, from);\n      });\n    });\n  });\n};\n\nexport const autotrack = () => {\n  const Router = getRouter();\n\n  if (!Router) {\n    return;\n  }\n\n  startRouter(Router);\n};\n\nexport default autotrack;\n","import { warn, isFn, loadScript } from \"./util\";\nimport api from \"./api\";\nimport { getRouter, getOptions } from \"../src/install\";\nimport optOut from \"./api/opt-out\";\nimport pageTracker from \"./page-tracker\";\n\nexport default function() {\n  if (typeof document === \"undefined\" || typeof window === \"undefined\") {\n    return;\n  }\n\n  const {\n    enabled,\n    globalObjectName,\n    globalDataLayerName,\n    config,\n    pageTrackerEnabled,\n    onReady,\n    disableScriptLoad\n  } = getOptions();\n\n  const Router = getRouter();\n  const isPageTrackerEnabled = Boolean(pageTrackerEnabled && Router);\n\n  if (!enabled) {\n    optOut();\n  }\n\n  if (window[globalObjectName] == null) {\n    window[globalDataLayerName] = window[globalDataLayerName] || [];\n    window[globalObjectName] = function() {\n      window[globalDataLayerName].push(arguments);\n    };\n  }\n\n  window[globalObjectName](\"js\", new Date());\n\n  if (isPageTrackerEnabled) {\n    pageTracker();\n  } else {\n    api.config(config.params);\n  }\n\n  if (disableScriptLoad) {\n    return;\n  }\n\n  const domain = \"https://www.googletagmanager.com\";\n  const resource = `${domain}/gtag/js?id=${config.id}&l=${globalDataLayerName}`;\n\n  return loadScript(resource, domain)\n    .then(() => {\n      const library = window[globalObjectName];\n\n      if (isFn(onReady)) {\n        onReady(library);\n      }\n\n      return library;\n    })\n    .catch(error => {\n      warn(\"Ops! Something happened and gtag.js couldn't be loaded\", error);\n      return error;\n    });\n}\n","import { setOptions as _setOptions, install } from \"./install\";\nimport _bootstrap from \"./bootstrap\";\nimport api from \"./api\";\n\nexport default install;\nexport { install };\n\nexport const bootstrap = _bootstrap;\nexport const setOptions = _setOptions;\n\n// export api for usages outside Vuejs context\nexport const query = api.query;\nexport const config = api.config;\nexport const event = api.event;\nexport const pageview = api.pageview;\nexport const screenview = api.screenview;\nexport const customMap = api.customMap;\nexport const time = api.time;\nexport const exception = api.exception;\nexport const linker = api.linker;\nexport const purchase = api.purchase;\nexport const set = api.set;\nexport const optIn = api.optIn;\nexport const optOut = api.optOut;\n"],"names":["noop","warn","msg","err","console","stack","isObject","item","_typeof","Array","isArray","globalObjectName","getOptions","window","Vue","Router","args","config","includes","query","id","forEach","domain","name","_params","defaultGroupName","params","send_to","map","include","concat","arg","page_path","page_location","location","href","event","value","disable","pageview","screenview","customMap","custom_map","time","exception","linker","purchase","refund","set","optIn","optOut","getVue","$gtag","prototype","api","trackPage","to","from","pageTrackerSkipSamePath","pageTrackerScreenviewEnabled","path","newParams","pageTrackerTemplate","appName","customTemplate","app_name","screen_name","page_title","getPageviewTemplate","autotrack","getRouter","onBeforeTrack","onAfterTrack","onReady","current","nextTick","then","afterEach","startRouter","document","enabled","globalDataLayerName","pageTrackerEnabled","disableScriptLoad","isPageTrackerEnabled","Boolean","push","arguments","Date","pageTracker","url","Promise","resolve","reject","head","getElementsByTagName","script","createElement","async","src","charset","link","rel","appendChild","onload","onerror","loadScript","library","catch","error","options","bootstrap","setOptions","_options","mergeDeep","target","sources","length","source","shift","key","Object","assign","install","_Vue","_Router","extend","_bootstrap","_setOptions"],"mappings":"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"}